<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head><body><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>Нукешова </b></span><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>Инди</b></span><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>ра.</b></span><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>&nbsp;</b></span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>Транзакции</b></span><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>. </b></span><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>Задание 8. Гл. 9 (2, 3)</b></span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;border-left:none;border-top:none;border-right:none;border-bottom:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>№ 2</b></span></p><ol style="padding-left:40px"><li style="list-style-type: decimal"><p style="margin-left:35.45pt;text-indent:-18pt;margin-top:0pt;margin-bottom:10pt;border:none;border-left:none;border-top:none;border-right:none;border-bottom:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Сценарий: </span></p></li></ol><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">&nbsp;&nbsp; - В первой транзакции мы выбираем самолет Cessna 208 Caravan с дальностью 1200 км, обновляем его дальность до 2100 км, и уменьшаем дальность Bombardier CRJ-200 до 1900 км.</span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">&nbsp;&nbsp; - Во второй транзакции мы пытаемся удалить самолеты с дальностью менее 2000 км, что блокируется первой транзакцией.</span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">2) Результат ROLLBACK</span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">&nbsp;&nbsp; - После выполнения `ROLLBACK` изменения первой транзакции отменяются, и Cessna 208 Caravan снова имеет дальность 1200 км. </span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">&nbsp;&nbsp; - Однако при выполнении команды DELETE во второй транзакции мы получаем `DELETE 0`, так как строка была заблокирована, и команда не пересчитывает условия.</span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">3) </span><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Уровень изоляции Read Committed позволяет транзакциям видеть только свои изменения и зафиксированные изменения других, что может привести к неожиданным результатам, как в этом случае.</span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:12pt;background-color:#ffff00;color:#000000;mso-style-textfill-fill-color:#000000"><b>№ 3</b></span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Да, в данном случае имеет место потерянное обновление, так как одно обновление перезаписывает значение другого.</span></p><p style="margin-top:0pt;margin-bottom:10pt;border:none;border-left:none;border-top:none;border-right:none;border-bottom:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Для предотвращения:</span></p><ol style="padding-left:40px"><li style="list-style-type: decimal"><p style="margin-left:35.45pt;text-indent:-18pt;margin-top:0pt;margin-bottom:10pt;border:none;mso-border-left-alt:none;mso-border-top-alt:none;mso-border-right-alt:none;mso-border-bottom-alt:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Используйте уровень изоляции </span><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Serializable</span><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">, который блокирует строки от изменений.</span></p></li><li style="list-style-type: decimal"><p style="margin-left:35.45pt;text-indent:-18pt;margin-top:0pt;margin-bottom:10pt;border:none;border-left:none;border-top:none;border-right:none;border-bottom:none;mso-border-between:none"><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">Применяйте </span><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">оптимистическую блокировку</span><span style="font-family:'Liberation Sans';font-size:9pt;color:#000000;mso-style-textfill-fill-color:#000000">, проверяя текущее значение перед обновлением.</span></p></li></ol><p style="margin-top:0pt;margin-bottom:10pt;border:none;border-left:none;border-top:none;border-right:none;border-bottom:none;mso-border-between:none">&nbsp;</p></body></html>